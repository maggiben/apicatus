<!DOCTYPE html>
<html lang="en" class="no-js live" ng-app="apicatus"><!--<![endif]-->
    <head>
        <title>apicatus</title>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <meta charset="utf-8">
        <!-- Bootstrap core CSS -->
        <link href="stylesheets/bootstrap.css" rel="stylesheet">
        <link href="stylesheets/bootstrap-theme.css" rel="stylesheet">
        <link href="stylesheets/bootstrap-select.css">
        <link href="stylesheets/base.css" rel="stylesheet">
    </head>
    <body>
        <nav class="navbar navbar-static-top" role="navigation">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex5-collapse">
                <i class="glyphicon glyphicon-list"></i>
              </button>
              <a class="navbar-brand" href="#"><img src="images/logo3.svg"></a>
            </div>

            <div class="colors-container" style="display:none">
                <div class="color-panel" cz-color="rgb(214,176,207)" style="background:rgb(214,176,207)" title="rgb(214,176,207)">&nbsp;</div><div class="color-panel" cz-color="rgb(27,148,151)" style="background:rgb(27,148,151)" title="rgb(27,148,151)">&nbsp;</div><div class="color-panel" cz-color="rgb(22,155,158)" style="background:rgb(22,155,158)" title="rgb(22,155,158)">&nbsp;</div><div class="color-panel" cz-color="rgb(80,204,204)" style="background:rgb(80,204,204)" title="rgb(80,204,204)">&nbsp;</div><div class="color-panel" cz-color="rgb(3,165,159)" style="background:rgb(3,165,159)" title="rgb(3,165,159)">&nbsp;</div><div class="color-panel" cz-color="rgb(5,147,141)" style="background:rgb(5,147,141)" title="rgb(5,147,141)">&nbsp;</div><div class="color-panel" cz-color="rgb(0,166,157)" style="background:rgb(0,166,157)" title="rgb(0,166,157)">&nbsp;</div><div class="color-panel" cz-color="rgb(0,128,121)" style="background:rgb(0,128,121)" title="rgb(0,128,121)">&nbsp;</div><div class="color-panel" cz-color="rgb(6,169,161)" style="background:rgb(6,169,161)" title="rgb(6,169,161)">&nbsp;</div><div class="color-panel" cz-color="rgb(21,136,128)" style="background:rgb(21,136,128)" title="rgb(21,136,128)">&nbsp;</div><div class="color-panel" cz-color="rgb(27,161,154)" style="background:rgb(27,161,154)" title="rgb(27,161,154)">&nbsp;</div><div class="color-panel" cz-color="rgb(46,183,176)" style="background:rgb(46,183,176)" title="rgb(46,183,176)">&nbsp;</div><div class="color-panel" cz-color="rgb(192,231,229)" style="background:rgb(192,231,229)" title="rgb(192,231,229)">&nbsp;</div><div class="color-panel" cz-color="rgb(229,247,246)" style="background:rgb(229,247,246)" title="rgb(229,247,246)">&nbsp;</div><div class="color-panel" cz-color="rgb(255,247,72)" style="background:rgb(255,247,72)" title="rgb(255,247,72)">&nbsp;</div><div class="color-panel" cz-color="rgb(240,104,4)" style="background:rgb(240,104,4)" title="rgb(240,104,4)">&nbsp;</div><div class="color-panel" cz-color="rgb(0,0,0)" style="background:rgb(0,0,0)" title="rgb(0,0,0)">&nbsp;</div><div class="color-panel" cz-color="rgb(102,102,102)" style="background:rgb(102,102,102)" title="rgb(102,102,102)">&nbsp;</div><div class="color-panel" cz-color="rgb(117,117,117)" style="background:rgb(117,117,117)" title="rgb(117,117,117)">&nbsp;</div><div class="color-panel" cz-color="rgb(122,122,122)" style="background:rgb(122,122,122)" title="rgb(122,122,122)">&nbsp;</div><div class="color-panel" cz-color="rgb(128,128,128)" style="background:rgb(128,128,128)" title="rgb(128,128,128)">&nbsp;</div><div class="color-panel" cz-color="rgb(142,142,142)" style="background:rgb(142,142,142)" title="rgb(142,142,142)">&nbsp;</div><div class="color-panel" cz-color="rgb(192,192,192)" style="background:rgb(192,192,192)" title="rgb(192,192,192)">&nbsp;</div><div class="color-panel" cz-color="rgb(255,255,255)" style="background:rgb(255,255,255)" title="rgb(255,255,255)">&nbsp;</div></div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-ex5-collapse secondary-b-1">
                <div class="navbar-form navbar-left">
                        <button type="submit" class="btn btn-menu btn-notifications hillited"><i class="glyphicon glyphicon-bell"></i><span class="label count pull-right">2</span></button>
                </div>
                <div class="navbar-form navbar-right">
                    <button type="submit" class="btn btn-menu transparent hillited"><i class="glyphicon glyphicon-th"></i></button>
                    <a href="#/profile" class="btn btn-menu transparent hillited"><i class="glyphicon glyphicon-user"></i></a>
                </div>
                <form class="navbar-form navbar-right">
                        <div class="form-group" style="width: 240px">
                            <div class="input-group">
                                <input type="search" placeholder="Search" class="form-control" data-provide="typeahead" autocomplete="off" data-items="4" data-source='["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Dakota","North Carolina","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"]'>
                                <div class="input-group-btn">
                                    <button type="button" class="btn btn-menu"><i class="glyphicon glyphicon-search"></i></button>
                                    <button type="button" class="btn btn-menu dropdown-toggle" data-toggle="dropdown" tabindex="-1">
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu" role="menu">
                                        <li role="presentation" class="dropdown-header">Search:</li>
                                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#"><i class="glyphicon glyphicon-th-large"></i>Applications</a></li>
                                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#"><i class="glyphicon glyphicon-th"></i>Containers</a></li>
                                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#"><i class="glyphicon glyphicon-user"></i>Users</a></li>
                                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#"><i class="glyphicon glyphicon-envelope"></i>Messages</a></li>
                                        <li role="presentation" class="divider"></li>
                                        <li role="presentation"><a role="menuitem" tabindex="-1" href="#"><i class="glyphicon glyphicon-eye-open"></i>Advanced search</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                </form>
            </div><!-- /.navbar-collapse -->
            <!-- ul class="colorin">
                <li style="width: 12%;" class="secondary-a-2"></li>
                <li style="width: 8%;" class="primary-2"></li>
                <li style="width: 6%;" class="secondary-b-3"></li>
                <li style="width: 4%;" class="secondary-a-5"></li>
                <li style="width: 13%;" class="secondary-a-1"></li>
                <li style="width: 10%;" class="primary-1"></li>
                <li style="width: 3%;" class="secondary-a-4"></li>
                <li style="width: 17%;" class="complement-3"></li>
                <li style="width: 9%;" class="secondary-a-2"></li>
                <li style="width: 10%" class="secondary-b-3"></li>
                <li style="width: 8%" class="primary-1"></li>
            </ul -->
        </nav>

        <div ng-view></div>

        <!-- MODALS -->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title">Modal title</h4>
                    </div>
                    <div class="modal-body">
                      ...
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div>
        <!-- MODALS -->

        <footer class="navbar-fixed-bottom brand-sprite stripe">
            <!-- ul class="colorin">
                <li style="width: 12%;" class="secondary-a-2"></li>
                <li style="width: 8%;" class="primary-2"></li>
                <li style="width: 6%;" class="secondary-b-3"></li>
                <li style="width: 4%;" class="secondary-a-5"></li>
                <li style="width: 13%;" class="secondary-a-1"></li>
                <li style="width: 10%;" class="primary-1"></li>
                <li style="width: 3%;" class="secondary-a-4"></li>
                <li style="width: 17%;" class="complement-3"></li>
                <li style="width: 9%;" class="secondary-a-2"></li>
                <li style="width: 10%" class="secondary-b-3"></li>
                <li style="width: 8%" class="primary-1"></li>
            </ul -->
        </footer>
        <script src="js/jquery-1.8.2.js"></script>
        <script src="js/modernizr.custom.js"></script>
        <script src="js/bootstrap.js"></script>
        <script src="js/jquery-ui.js"></script>


        <script src="js/angular.js"></script>
        <script src="js/angular-route.js"></script>
        <script src="js/ui-bootstrap-tpls-0.6.0.js"></script>

        <script src="js/bootstrap-select.js"></script>

        <!-- Chang URLs to wherever Video.js files will be hosted -->
        <script>
        $(document).ready(function() {
            $('.selectpicker').selectpicker();
        });
            /*global angular */
            /*jshint unused:false */
            'use strict';
            var headers = {
                "statuses": [
                    { id: 100, group: "Informational", label: 100, code: 100, title: "Continue", description: "Client should continue with request" },
                    { id: 101, group: "Informational", label: 101, code: 101, title: "Switching Protocols", description: "Server is switching protocols" },
                    { id: 102, group: "Informational", label: 102, code: 102, description: "Server has received and is processing the request" },
                    { id: 103, group: "Informational", label: 103, code: 103, description: "Resume aborted PUT or POST requests" },
                    { id: 122, group: "Informational", label: 122, code: 122, description: "URI is longer than a maximum of 2083 characters" },

                    { id: 200, group: "Success", label: 200, code: 200, title: "OK", description: "standard response for successful HTTP requests" },
                    { id: 201, group: "Success", label: 201, code: 201, title: "Created", description: "request has been fulfilled; new resource created" },
                    { id: 202, group: "Success", label: 202, code: 202, title: "Accepted", description: "request accepted, processing pending" },
                    { id: 203, group: "Success", label: 203, code: 203, title: "Non-Authoritative Information", description: "request processed, information may be from another source" },
                    { id: 204, group: "Success", label: 204, code: 204, title: "No Content", description: "request processed, no content returned" },
                    { id: 205, group: "Success", label: 205, code: 205, title: "Reset Content", description: "request processed, no content returned, reset document view" },
                    { id: 206, group: "Success", label: 206, code: 206, title: "Partial Content", description: "partial resource return due to request header" },
                    { id: 207, group: "Success", label: 207, code: 207, description: "XMLl, can contain multiple separate responses" },
                    { id: 208, group: "Success", label: 208, code: 208, description: "results previously returned" },
                    { id: 226, group: "Success", label: 226, code: 226, description: "request fulfilled, reponse is instance-manipulations" },

                    { id: 200, group: "Redirection", label: 200, code: 200, description: "multiple options for the resource delivered" },
                    { id: 201, group: "Redirection", label: 201, code: 201, description: "this and all future requests directed to the given URI" },
                    { id: 302, group: "Redirection", label: 302, code: 302, description: "temporary response to request found via alternative URI" },
                    { id: 303, group: "Redirection", label: 303, code: 303, description: "permanent response to request found via alternative URI" },
                    { id: 304, group: "Redirection", label: 304, code: 304, description: "resource has not been modified since last requested" },
                    { id: 305, group: "Redirection", label: 305, code: 305, description: "content located elsewhere, retrieve from there" },
                    { id: 306, group: "Redirection", label: 306, code: 306, description: "subsequent requests should use the specified proxy" },
                    { id: 307, group: "Redirection", label: 307, code: 307, description: "connect again to different uri as provided" },
                    { id: 308, group: "Redirection", label: 308, code: 308, description: "resumable HTTP Requests" },

                    { id: 400, group: "Client Error", label: 400, code: 400, description: "request cannot be fulfilled due to bad syntax" },
                    { id: 401, group: "Client Error", label: 401, code: 401, description: "authentication is possible but has failed" },
                    { id: 402, group: "Client Error", label: 402, code: 402, description: "payment required, reserved for future use" },
                    { id: 403, group: "Client Error", label: 403, code: 403, description: "server refuses to respond to request" },
                    { id: 404, group: "Client Error", label: 404, code: 404, description: "requested resource could not be found" },
                    { id: 405, group: "Client Error", label: 405, code: 405, description: "request method not supported by that resource" },
                    { id: 406, group: "Client Error", label: 406, code: 406, description: "content not acceptable according to the Accept headers" },
                    { id: 407, group: "Client Error", label: 407, code: 407, description: "client must first authenticate itself with the proxy" },
                    { id: 408, group: "Client Error", label: 408, code: 408, description: "server timed out waiting for the request" },
                    { id: 409, group: "Client Error", label: 409, code: 409, description: "request could not be processed because of conflict" },
                    { id: 410, group: "Client Error", label: 410, code: 410, description: "resource is no longer available and will not be available again" },
                    { id: 411, group: "Client Error", label: 411, code: 411, description: "request did not specify the length of its content" },
                    { id: 412, group: "Client Error", label: 412, code: 412, description: "server does not meet request preconditions" },
                    { id: 413, group: "Client Error", label: 413, code: 413, description: "request is larger than the server is willing or able to process" },
                    { id: 414, group: "Client Error", label: 414, code: 414, description: "URI provided was too long for the server to process" },
                    { id: 415, group: "Client Error", label: 415, code: 415, description: "server does not support media type" },
                    { id: 416, group: "Client Error", label: 416, code: 416, description: "client has asked for unprovidable portion of the file" },
                    { id: 417, group: "Client Error", label: 417, code: 417, description: "server cannot meet requirements of Expect request-header field" },
                    { id: 418, group: "Client Error", label: 418, code: 418, description: "I'm a teapot" },
                    { id: 420, group: "Client Error", label: 420, code: 420, description: "Twitter rate limiting" },
                    { id: 422, group: "Client Error", label: 422, code: 422, description: "request unable to be followed due to semantic errors" },
                    { id: 423, group: "Client Error", label: 423, code: 423, description: "resource that is being accessed is locked" },
                    { id: 424, group: "Client Error", label: 424, code: 424, description: "request failed due to failure of a previous request" },
                    { id: 426, group: "Client Error", label: 426, code: 426, description: "client should switch to a different protocol" },
                    { id: 428, group: "Client Error", label: 428, code: 428, description: "origin server requires the request to be conditional" },
                    { id: 429, group: "Client Error", label: 429, code: 429, description: "user has sent too many requests in a given amount of time" },
                    { id: 431, group: "Client Error", label: 431, code: 431, description: "server is unwilling to process the request" },
                    { id: 444, group: "Client Error", label: 444, code: 444, description: "server returns no information and closes the connection" },
                    { id: 449, group: "Client Error", label: 449, code: 449, description: "request should be retried after performing action" },
                    { id: 450, group: "Client Error", label: 450, code: 450, description: "Windows Parental Controls blocking access to webpage" },
                    { id: 451, group: "Client Error", label: 451, code: 451, description: "The server cannot reach the client's mailbox." },
                    { id: 499, group: "Client Error", label: 499, code: 499, description: "connection closed by client while HTTP server is processing" },

                    { id: 500, group: "Server Error", label: 500, code: 500, description: "generic error message" },
                    { id: 501, group: "Server Error", label: 501, code: 501, description: "server does not recognise method or lacks ability to fulfill" },
                    { id: 502, group: "Server Error", label: 502, code: 502, description: "server received an invalid response from upstream server" },
                    { id: 503, group: "Server Error", label: 503, code: 503, description: "server is currently unavailable" },
                    { id: 504, group: "Server Error", label: 504, code: 504, description: "gateway did not receive response from upstream server" },
                    { id: 505, group: "Server Error", label: 505, code: 505, description: "server does not support the HTTP protocol version" },
                    { id: 506, group: "Server Error", label: 506, code: 506, description: "content negotiation for the request results in a circular reference" },
                    { id: 507, group: "Server Error", label: 507, code: 507, description: "server is unable to store the representation" },
                    { id: 508, group: "Server Error", label: 508, code: 508, description: "server detected an infinite loop while processing the request" },
                    { id: 509, group: "Server Error", label: 509, code: 509, description: "bandwidth limit exceeded" },
                    { id: 510, group: "Server Error", label: 510, code: 510, description: "further extensions to the request are required" },
                    { id: 511, group: "Server Error", label: 511, code: 511, description: "client needs to authenticate to gain network access" },
                    { id: 598, group: "Server Error", label: 598, code: 598, description: "network read timeout behind the proxy" },
                    { id: 599, group: "Server Error", label: 599, code: 599, description: "network connect timeout behind the proxy" }
                ],
                "methods": [
                    { id: 1, group: "RFC 2616", label: "OPTIONS", code: 100, title: "Continue", description: "Client should continue with request" },
                    { id: 2, group: "RFC 2616", label: "GET", code: 101, title: "Switching Protocols", description: "Server is switching protocols" },
                    { id: 3, group: "RFC 2616", label: "HEAD", code: 102, description: "Server has received and is processing the request" },
                    { id: 4, group: "RFC 2616", label: "POST", code: 103, description: "Resume aborted PUT or POST requests" },
                    { id: 5, group: "RFC 2616", label: "PUT", code: 122, description: "URI is longer than a maximum of 2083 characters" },
                    { id: 6, group: "RFC 2616", label: "DELETE", code: 122, description: "URI is longer than a maximum of 2083 characters" },
                    { id: 7, group: "RFC 2616", label: "TRACE", code: 122, description: "URI is longer than a maximum of 2083 characters" },
                    { id: 8, group: "RFC 2616", label: "CONNECT", code: 122, description: "URI is longer than a maximum of 2083 characters" },
                ],
                "contentTypes": [
                    { id: 100, group: "Application", label: "application/json" },
                    { id: 101, group: "Application", label: "application/x-www-form-urlencoded" },
                    { id: 102, group: "Application", label: "application/xhtml+xml" },
                    { id: 103, group: "Application", label: "application/xml" },
                    { id: 200, group: "Audio", label: "audio/mpeg" },
                    { id: 201, group: "Audio", label: "audio/ogg" },
                    { id: 300, group: "Image", label: "image/gif" },
                    { id: 301, group: "Image", label: "image/jpeg" },
                    { id: 302, group: "Image", label: "image/png" },
                    { id: 303, group: "Image", label: "image/svg+xml" },
                    { id: 400, group: "Message", label: "message/http" },
                    { id: 401, group: "Message", label: "message/partial" },
                    { id: 500, group: "Model", label: "model/vrml" },
                    { id: 600, group: "Multipart", label: "multipart/form-data" },
                    { id: 700, group: "Text", label: "text/css" },
                    { id: 701, group: "Text", label: "text/csv" },
                    { id: 702, group: "Text", label: "text/html" },
                    { id: 703, group: "Text", label: "text/json" },
                    { id: 704, group: "Text", label: "text/json" },
                    { id: 705, group: "Text", label: "text/xml" },
                    { id: 800, group: "Video", label: "video/mpeg" },
                    { id: 801, group: "Video", label: "video/mp4" },
                    { id: 802, group: "Video", label: "video/x-flv" }
                ]
            }
            var apiMock = {
                "_id": "",
                "name": "MyApi",
                "domain": "test",
                "baseurl": "/MyApi",
                "logging": "fase",
                "allowCrossDomain": true,
                "entries": [
                    {
                        "id": "z1",
                        "route": "/test",
                        "method": {"id": 2, "label": "GET"},
                        "parameters": {
                            headers: ["Required Parameters", "Description", "Version"],
                            values: [
                                ["api_key", "Api session key", "1.0"],
                                ["request_token", "The request token parameter is the token you generated for the user to approve.", "1.0"]
                            ]
                        },
                        "sends": "/data/test.json",
                        "status": { "id": 403 },
                        "contentType": { "id": 100 },
                        "description": "This method is used to generate a valid request token for user based authentication. A request token is required in order to request a session id. You can generate any number of request tokens but they will expire after 60 minutes. As soon as a valid session id has been created the token will be destroyed.",
                        "proxy": {
                            "enabled": true,
                            "url": "http://google.com"
                        },
                        "hits": 244,
                        "isEditing": false
                    },
                    {
                        "id": "z2",
                        "route": "/test2",
                        "method": {"id": 2, "label": "GET"},
                        "parameters": {
                            headers: ["Required Parameters", "Description", "Version"],
                            values: [
                                ["api_key", "Api session key", "1.0"],
                                ["request_token", "The request token parameter is the token you generated for the user to approve.", "1.0"]
                            ]
                        },
                        "sends": "/data/test.json",
                        "status": { "id": 204 },
                        "contentType": { "id": 701 },
                        "description": "stuff",
                        "proxy": {
                            "enabled": false,
                            "url": "http://yahoo.com"
                        },
                        "hits": 1200,
                        "isEditing": false
                    }
                ]
            };
            var apicatus = angular.module('apicatus', ['ui.bootstrap', 'ngRoute'])
            .config(['$routeProvider', function($routeProvider) {
              $routeProvider.when('/resource/:id', {templateUrl: 'views/resources.html', controller: 'ApiEntryListCtrl', resolve: ApiEntryListCtrl.resolve});
              $routeProvider.when('/digestors', {templateUrl: 'views/digestors.html', controller: 'HomeController', resolve: HomeController.resolve});
              $routeProvider.when('/profile', {templateUrl: 'views/profile.html', controller: 'UserCtl', resolve: UserCtl.resolve});
              $routeProvider.otherwise({redirectTo: '/digestors'});
            }]);

            function ApiEntryListCtrl($scope, $location, $q, $http, $routeParams, apicatusStorage, apicatusHelpers, api) {
                console.log("api");
                console.log(api)
                $scope.api = api;
                $scope.$watch('api', function (newValue, oldValue) {
                    if (newValue !== oldValue) { // This prevents unneeded calls to the local storage
                        apicatusStorage.put(api);
                    }
                }, true);
                $scope.headers = headers;
                $scope.addResource = function () {
                    $scope.api.entries.push({
                        "id": apicatusHelpers.guid(),
                        "route": "",
                        "method": {"id": 2, "label": "GET"},
                        "parameters": {
                            headers: [],
                            values: []
                        },
                        "sends": "",
                        "status": { "id": 204 },
                        "contentType": { "id": 100 },
                        "description": "",
                        "proxy": {
                            "enabled": false,
                            "url": ""
                        },
                        "hits": 0,
                        "isEditing": false
                    });
                };

                $scope.removeResource = function (resource) {
                    console.log(resource);
                    $scope.api.entries.splice($scope.api.entries.indexOf(resource), 1);
                };
            };
            ApiEntryListCtrl.resolve = {
                api: function($q, $http, $route, apicatusStorage) {
                    return apicatusStorage.get($route.current.params.id);
                }
            }

            function HomeController($scope, $location, $q, $http, HomeControllerStorage, apicatusHelpers, apis) {
                    $scope.apis = apis;
                    $scope.currentPage = 0;
                    $scope.pageSize = 10;
                    $scope.numberOfPages = function() {
                        return Math.ceil($scope.apis.length/$scope.pageSize);
                    }
                    $scope.getPages = function(num) {
                        var range = [];
                        var i = 0;
                        for(i = 0; i < num; i += 1) {
                            range.push(i);
                        }
                        return range;
                    }
                    $scope.prevPage = function () {
                        if ($scope.currentPage > 0) {
                            $scope.currentPage--;
                        }
                    };

                    $scope.nextPage = function () {
                        if ($scope.currentPage < $scope.numberOfPages() - 1) {
                            $scope.currentPage++;
                        }
                    };
            }
            HomeController.resolve = {
                apis: function($q, $http, HomeControllerStorage) {
                    return HomeControllerStorage.get();
                }
            }
            /*
            .controller('HomeController', function HomeController($scope, $location, $q, $http, HomeControllerStorage, apicatusHelpers) {
                var promise = HomeControllerStorage.get();
                console.log("HomeController")
                promise.then(function(apis) {
                    console.log("DATAOK")
                    $scope.apis = apis;
                    $scope.currentPage = 0;
                    $scope.pageSize = 10;
                    $scope.$watch('apis', function (newValue, oldValue) {
                        if (newValue !== oldValue) { // This prevents unneeded calls to the local storage
                            HomeControllerStorage.put(apis);
                        }
                    }, true);
                    //$location.path( "/view2" );
                });
                $scope.numberOfPages=function(){
                    return Math.ceil($scope.apis.length/$scope.pageSize);
                }
                $scope.resolve = {
                  myHttpResponse : function($http) {
                    return $http({
                        method: 'GET',
                        url: 'http://google.com'
                    })
                    .success(function(data, status) {
                        console.log("google is ok")
                        // Probably no need to do anything here.
                    })
                    .error(function(data, status){
                        // Maybe add an error message to a service here.
                        // In this case your $http promise was rejected automatically and the view won't render.
                    });
                  }
              }
            });
            */
            apicatus.factory('apicatusHelpers', function() {
                return {
                    guid: function() {
                        var stack = [];
                        var itoh = '0123456789ABCDEF';
                        var i = 0;
                        // Make array of random hex digits. The UUID only has 32 digits in it, but we
                        // allocate an extra items to make room for the '-'s we'll be inserting.
                        for (i = 0; i < 36; i += 1) {
                            stack[i] = Math.floor(Math.random()*0x10);
                        }
                        // Conform to RFC-4122, section 4.4
                        stack[14] = 4;  // Set 4 high bits of time_high field to version
                        stack[19] = (stack[19] && 0x3) || 0x8;  // Specify 2 high bits of clock sequence
                        // Convert to hex chars
                        for (i = 0; i < 36; i += 1) {
                            stack[i] = itoh[stack[i]];
                        }
                        // Insert '-'s
                        stack[8] = stack[13] = stack[18] = stack[23] = '-';

                        return stack.join('');
                    }
                }
            })
            apicatus.factory('apicatusStorage', function ($q, $http) {
                var STORAGE_ID = 'apicatus-angularjs';
                return {
                    get: function (id) {
                        console.log("id: " + id)
                        var deferred = $q.defer();
                        $http({method: 'GET', url: '/digestors/' + id}).
                        success(function(data, status, headers, config) {
                            // this callback will be called asynchronously
                            // when the response is available
                            //deferred.resolve( apiMock );
                            deferred.resolve(data);
                        }).
                        error(function(data, status, headers, config) {
                            // called asynchronously if an error occurs
                            // or server returns response with an error status.
                            // Get local version
                            var localData = JSON.parse(localStorage.getItem(STORAGE_ID) || '[]');
                            deferred.reject(localData);
                        });
                        return deferred.promise;
                    },
                    put: function (api) {
                        console.log("saving id: " + api.name)
                        $http.put('/digestors/' + api.name, api).
                        success(function(data, status, headers, config) {
                            // this callback will be called asynchronously
                            // when the response is available
                            return data;
                        }).
                        error(function(data, status, headers, config) {
                            // called asynchronously if an error occurs
                            // or server returns response with an error status.
                            // Save local version
                            localStorage.setItem(STORAGE_ID, JSON.stringify(api));
                        });

                    }
                };
            });
            apicatus.factory('HomeControllerStorage', function ($q, $http) {
                var STORAGE_ID = 'apicatus-angularjs';
                return {
                    get: function () {
                        var deferred = $q.defer();
                        $http({method: 'GET', url: '/digestors'}).
                        success(function(data, status, headers, config) {
                            // this callback will be called asynchronously
                            // when the response is available
                            //deferred.resolve( apiMock );
                            deferred.resolve(data);
                        }).
                        error(function(data, status, headers, config) {
                            // called asynchronously if an error occurs
                            // or server returns response with an error status.
                            // Get local version
                            var localData = JSON.parse(localStorage.getItem(STORAGE_ID) || '[]');
                            deferred.reject(localData);
                        });
                        return deferred.promise;
                    },
                    put: function (api) {
                        console.log(api)
                        $http.put('/digestors/', api).
                        success(function(data, status, headers, config) {
                            // this callback will be called asynchronously
                            // when the response is available
                            return data;
                        }).
                        error(function(data, status, headers, config) {
                            // called asynchronously if an error occurs
                            // or server returns response with an error status.
                            // Save local version
                            localStorage.setItem(STORAGE_ID, JSON.stringify(api));
                        });

                    }
                };
            });
            // Services
            // Filters
            //We already have a limitTo filter built-in to angular,
            //let's make a startFrom filter
            apicatus.filter('startFrom', function() {
                return function(input, start) {
                    start = +start; //parse to int
                    return input.slice(start);
                }
            });

        </script>
        <script src="javascripts/controllers/userCtrl.js"></script>
    </body>
</html>